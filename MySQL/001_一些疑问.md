# 一些疑问

1.DISTINCT与GROUP BY的区别？

2.ORDER BY时区分大小写

**3.Group By多列该怎么理解？**

参考：[Using group by on multiple columns](https://stackoverflow.com/questions/2421388/using-group-by-on-multiple-columns)

> `Group By X, Y` means **put all those with the same values for both X and Y in the one group**.
>
> 意思是把X和Y都相同的放在一个group
>
> ```
> Table: Subject_Selection
> 
> Subject   Semester   Attendee
> ---------------------------------
> ITB001    1          John
> ITB001    1          Bob
> ITB001    1          Mickey
> ITB001    2          Jenny
> ITB001    2          James
> MKB114    1          John
> MKB114    1          Erica
> ```
>
> group by一列
>
> ```sql
> select Subject, Count(*)
> from Subject_Selection
> group by Subject
> ```
>
> 结果为：
>
> ```
> Subject    Count
> ------------------------------
> ITB001     5
> MKB114     2
> ```
>
> group by两列
>
> ```sql
> select Subject, Semester, Count(*)
> from Subject_Selection
> group by Subject, Semester
> ```
>
> 结果为：
>
> ```
> Subject    Semester   Count
> ------------------------------
> ITB001     1          3
> ITB001     2          2
> MKB114     1          2
> ```



**4.提示SELECT list is not in GROUP BY clause and contains nonaggregated column**

在使用GROUP BY时，提示SELECT列表中有包含未聚合的列，如下的sql

```mysql
SELECT 
	d1.district, 
	d1.`name`,
	d1.price AS price, 
	COUNT(d2.name) + 1 AS rank_1
FROM DistrictProducts d1 LEFT OUTER JOIN DistrictProducts d2 
ON d1.district = d2.district 
AND d1.price < d2.price
GROUP BY d1.district, d1.name
ORDER BY d1.district, rank_1;
```

提示：

```text
1055 - Expression #3 of SELECT list is not in GROUP BY clause and contains nonaggregated column 'sqlpro.d1.price' which is not functionally dependent on columns in GROUP BY clause; this is incompatible with sql_mode=only_full_group_by, Time: 0.000000s
```

查了下，都说要修改SQL mode，但其实也可以不这样，直接使用聚合函数：

```mysql
SELECT 
	d1.district, 
	d1.`name`,
	MAX(d1.price) AS price, 
	COUNT(d2.name) +1 AS rank_1
FROM DistrictProducts d1 LEFT OUTER JOIN DistrictProducts d2 
ON d1.district = d2.district 
AND d1.price < d2.price
GROUP BY d1.district, d1.name
ORDER BY d1.district, rank_1;
```

>除聚合函数外，SELECT语句中的每个列都必须在GROUP BY子句中给出
>
>----MySQL必知必会

















